# Task ID: 5
# Title: Fix Test Command Matching
# Status: done
# Dependencies: 2
# Priority: medium
# Description: Correct the test implementation to ensure mock commands are properly matched with their scenarios for accurate testing.
# Details:
1. Update test layer creation to use consistent command keys:
```typescript
const testLayer = TestCommandExecutor({
  // Use a serialized version of the actual command being tested
  [serializeCommand(commandObj)]: {
    output: [expectedOutput],
  },
});
```
2. Create a helper function for test scenario creation that ensures keys match
3. Update all tests to use this consistent approach
4. Add validation to test setup to catch mismatched commands

# Test Strategy:
1. Create meta-tests that verify test infrastructure works correctly
2. Test with various command types to ensure proper matching
3. Verify that tests fail when expected (negative testing)
4. Create tests that verify the same command always matches the same scenario
